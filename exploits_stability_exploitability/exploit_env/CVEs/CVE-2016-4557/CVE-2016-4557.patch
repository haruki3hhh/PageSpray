diff --git a/kernel/bpf/verifier.c b/kernel/bpf/verifier.c
index 13551e623..09be5dbbb 100644
--- a/kernel/bpf/verifier.c
+++ b/kernel/bpf/verifier.c
@@ -4211,6 +4211,7 @@ static int replace_map_fd_with_map_ptr(struct bpf_verifier_env *env)
 			if (IS_ERR(map)) {
 				verbose(env, "fd %d is not pointing to valid bpf_map\n",
 					insn->imm);
+				fdput(f);
 				return PTR_ERR(map);
 			}
 
